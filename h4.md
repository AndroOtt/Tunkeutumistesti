X1) https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

Artikkeli käy läpi fuffin ominaisuuksia. Fuff on työkalu millä pystyy etsimään sivustojen piilotettuja hakemistoja. 

Mikä on fuzzing? Se on automaattinen tapa testaa tuhansia eri muotoista dataa, tässä tapauksessa eri URL:eja jotta voisimme löytää jonkun URL:in minne meillä ei pitäisi olla pääsyä. 

Miten Fuzz ladataan? 

$ sudo apt-get update

$ sudo apt-get install ffuf

Fuzz kuitenkin tarvitsee erilaisia hakemistoja, jotta työkalua voitaisiin hyödyntää. Sellaisen voi kirjoittaa itse, tai ladata suoraan netistä. Artikkeli ehdottaa Seclistiltä ladattavaa tiedostoa missä on yli 5 tuhatta hakemistoa. 

Seuraavaksi käydään eri komentoja läpi, miten fuzzia käytetään ja mitä kaikkea komennot tekee. 

Fuzz tuottaa paljon dataa, mitä ei voi sellaisenaan käyttää. Pitää etsiä yhtenäisyyksiä datasta, jotta voi filtteröidä tietoja. 

Suodattamisen jälkeen löytyi muutama mielenkiintoinen hakemisto ja siitä me löydettiinkin hakemistoja mihin meillä ei pitäisi olla pääsyä.

X2) https://www.youtube.com/watch?v=mbmsT3AhwWU

Video aloittaa HTTP requesteistä ja mitä fuzzaaminen tekee. Miten fuzz liittyy tähän ja miten sitä hyödynnetään.

Videosta käy ilmi, että paljon muutakin pystyy tekemään fuzzerillä kuin mitä aluksi ajattelin. 

<img width="933" height="525" alt="image" src="https://github.com/user-attachments/assets/ff2b5469-eeeb-4c6e-b36a-d4668b4ffe32" />

Joohoi kertoi siitä, miksi teki kyseisen työkalun. Iso syy oli, että nykyisiin avoimiin lähdekoodeihin perustuvat samankaltaiset työkalut eivät tarjonneet asioita mitä hän kaipasi ja olemassaoleviin työkaluihin koodibaseihin voinut vaikuttaa mitenkään.

Demossa Joohoi kertoo mitä työkalu tekee ja miksi hän käyttää kyseisiä inputtejä.

Fuzzia voi käyttää PW brute forcaamiseen. Videossa käydään hyvin tarkasti läpi miten brute forcaaminen tapahtuu ja mitä komentoja kannattaisi käyttää.

A)
Ffuf ladattu ja asennettu.

<img width="707" height="516" alt="image" src="https://github.com/user-attachments/assets/f57de530-3618-4d6f-809b-7fe3e527085f" />

<img width="703" height="502" alt="image" src="https://github.com/user-attachments/assets/8c09d3fc-0986-41c2-b3ad-64b3e088f744" />

Tässä käytin komentoa 

$ wget https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/dirfuzt-1

$ chmod u+x dirfuzt-1

chmod = antaa/vaihtaa oikeudet tiedostolle

u + x = ownder / execute 

$ ./dirfuzt-1 = tiedoston nimi, mihin navigoidaan

Pääsin selaimella avaamaan dirfutz-1

<img width="1148" height="832" alt="image" src="https://github.com/user-attachments/assets/2168d27a-707a-4dab-848b-c1abe68b46b4" />

Tässä yritin käyttää fuffia, komentolla: ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ

ffuf = moduuli jota kutsutaan komentorivillä, jotta konee tietää mitä ohjelmaa pitää pyörittää ja mihin ohjelmaan komennot kuuluvat

-w = (Optional) Vaihtoehto, tällöin fuff tietää että halutaan käyttää tiedostoa missä on testattavat hakemistot

common.txt = tiedosto missä on testattavat hakemistot

-u = Target url

http://127.0.0.2:8000/FUZZ = URL

<img width="706" height="495" alt="image" src="https://github.com/user-attachments/assets/c565ea3f-cf92-49ca-a97d-878729348c6b" />

Tein jotain todennäköisesti väärin, koska fuffin nopeudesta ei ollut hajuakaan, minulla kesti useita minuutteja tehdä 5000 requestia. (Yhteensä 40 min)

Testin jälkeen en saanut yhtäkään requestia näkyviin, joten yritän uudelleen.

<img width="696" height="502" alt="image" src="https://github.com/user-attachments/assets/c30ba70f-1311-41d0-8db1-e2e63ec30eef" />

Nyt sain paljon requesteja ja nopeesti, kuten teron esimerkissä, huomasin että suurimmalla osalla requesteistä yhtenäinen tekijä on 154, joten koitan fitteröidä sen pois. 

Sama komento mutta nyt lisäsin -fs 154 perään.

<img width="694" height="487" alt="image" src="https://github.com/user-attachments/assets/f5942ef3-b807-432d-9b74-b82404f92833" />

Sain 12 matchia, filtteröin vielä 178 perusteella, sama komento mutta vaihdoin -fs 154,178.

<img width="659" height="55" alt="image" src="https://github.com/user-attachments/assets/b5f18ac8-46df-4043-8f7d-83075b7a574d" />

<img width="713" height="874" alt="image" src="https://github.com/user-attachments/assets/1ec80460-3ac9-402e-8d1c-dabba5d17848" />

Outputista löysin kaksi mielenkiintoista urlia, wp-admin ja git.

<img width="1564" height="848" alt="image" src="https://github.com/user-attachments/assets/aac4c14c-46be-46c3-8750-c7424cd4c28a" />

<img width="1584" height="837" alt="image" src="https://github.com/user-attachments/assets/dfda955c-21eb-4098-9b30-54dbb2606f8f" />


B) 

Varmistin, että Kali Linux pakettihallinta on viimeisellä versiolla. Tähän käytin komentoa sudo apt-get update


<img width="708" height="502" alt="image" src="https://github.com/user-attachments/assets/f51b3c9d-49b4-4235-84cf-f61ec1308c3a" />

Seuraavaksi asensin dokkerin, gitin ja fuffin.

sudo apt-get install docker.io git

<img width="708" height="499" alt="image" src="https://github.com/user-attachments/assets/0969d7af-0158-43ba-ad36-242ad0e62b0d" />

Kloonasin fuffme repon.

git clone https://github.com/adamtlangley/ffufme

<img width="659" height="168" alt="image" src="https://github.com/user-attachments/assets/0ee7c9e1-121a-485a-9608-1f8c83417b0e" />


Navigoin ffufme hakemistoon minkä äsken tehtiin ja yritin buildaa dokker imagen siellä. Kuitenkaan ei onnistunut.


<img width="550" height="164" alt="image" src="https://github.com/user-attachments/assets/fcb24ede-f46b-4be3-aad7-ecd4d183f1c5" />

Pienen debuggin jälkeen tajusin että "." on olennainen elementti komennossa, sillä se rakentaa dokker imagen suoraa siihen hakemistoon missä olen.

<img width="712" height="501" alt="image" src="https://github.com/user-attachments/assets/5ebcb595-f360-412e-bc0e-7ed842741fa8" />

Fuffme näyttäisi toimivan.

<img width="989" height="815" alt="image" src="https://github.com/user-attachments/assets/d3ce3c49-1e76-46d0-a5d9-6c9b6087eeb8" />

<img width="666" height="221" alt="image" src="https://github.com/user-attachments/assets/ca615e02-119c-4379-be5a-7a1245424207" />

Ensiksi tein uuden hakemiston ffufme:hen, nimeltään wordlist, siihen latasin kaikki tarvittavat teksi tiedostot.

wget = hakee http/s hakee tiedostoja ja lataa ne web palvelimilta.

<img width="706" height="841" alt="image" src="https://github.com/user-attachments/assets/dcf952ef-31a4-4966-bd39-9ebfee351f73" />

C) Tehtävä 1: "Basic Content Discovery"

Sen jälkeen kopioin komennon mikä näkyi tehtävässä, lisäsin komentoriville -v ja -c että data olisi luettavampaa ja siitä voi suoraan klikkaa hyperlinkkiä. (tämän idean sain joohon demo videosta)

<img width="687" height="730" alt="image" src="https://github.com/user-attachments/assets/7565bf99-6e3d-46cc-8c47-4e72be71375a" />

Hakemistot löytyivät. 

<img width="1760" height="852" alt="image" src="https://github.com/user-attachments/assets/00312339-634f-46b3-be3a-35774391086a" />

<img width="1135" height="806" alt="image" src="https://github.com/user-attachments/assets/fbc34062-b592-4c34-b772-f1feb8ee5a27" />

D) Tehtävä 2: "Recursion"

Siinä käytin samanlaista komentoa kuten aikasemmassa tehtävässä, mutta siihen piti lisätä -recursion. Lisäsin taas -v & -c, jotta data olisi luettavampaa.

$ -recursion $= Ensimmäisen hakemiston minkä fuff löytää, se yrittää brute forcaa sitä tiettyä hakemistoa lisää kunnes löytää jotain uutta, kunnes se ei löydä enää mitään.

<img width="693" height="785" alt="image" src="https://github.com/user-attachments/assets/e067e0a1-e4ad-45ff-8e8c-2c947840fdf9" />

Siitä löytyi mielenkiintoinen hakemisto, nimeltään "admin/users/96". 

<img width="699" height="524" alt="image" src="https://github.com/user-attachments/assets/38fad637-4a3d-49ce-ada4-72885bdba572" />

Sillä kun sen avaa niin tehtävä oli suoritettu. 

<img width="1142" height="798" alt="image" src="https://github.com/user-attachments/assets/aa5cad7d-634a-48e2-993f-c737eb66fa2e" />

Tässä myös huomasin miten recursion komento toimii, outputissa selkeesti näkyy, milloin fuff oli löytänyt admin hakemiston -> sieltä users -> users/96.

<img width="542" height="84" alt="image" src="https://github.com/user-attachments/assets/2d3b2057-3d75-4159-ad4d-2f338db15f33" />

<img width="540" height="77" alt="image" src="https://github.com/user-attachments/assets/a85a45b7-389c-4f9d-ab82-a2c23a8fe7f2" />

E) Tehtävä 3: "File Extensions"

Kuten aikasemmassa tehtävässä, käytetään samaa komentopohjaa, mutta muokataan pari flagia, lisätään -e ja .log komentoon + eri hakemisto tietysti.

$-e $= lisää jokaiseen common.txt tiedostossa olevalle riville .log perään ja kokeilee sillä tavalla etsiä oikeeta urlia

$.log $ = määrittää mitä tietoa -e laittaa

<img width="669" height="213" alt="image" src="https://github.com/user-attachments/assets/a5d41773-c947-476a-b5aa-e60c8ed53331" />

Hakemisto löytyi.

<img width="678" height="210" alt="image" src="https://github.com/user-attachments/assets/81511c24-8761-44ca-8b1d-4e7b7278afc3" />

<img width="985" height="442" alt="image" src="https://github.com/user-attachments/assets/ad65a81d-e463-4363-802e-649df73820fd" />

Tehtävä 4: "No 404 Status"

$ffuf -w wordlist/common.txt -u http://localhost/cd/no404/FUZZ -v -c$.

Ensimmäinen komento tuotti seuraavan hakutuloksen. Tämän tehtävän tarkoitus oli näyttää meille samaa mitä käytiin tehtävässä läpi B), eli miten suodatetaan hakutuloksia.

<img width="544" height="835" alt="image" src="https://github.com/user-attachments/assets/d00b1406-4599-4720-9ff8-1ca78240db79" />

Hakutuloksia syntyi paljon, joten meidän pitää suodattaa hakutulokset -fs 669 komennolla. Lisään komentoihin taas -v ja -c. Valitsin suuruudeksi 669 koska sitä esiintyi sample datassa eniten.

$-fs$ = Suodattaa tuloksen suuruuden perusteella pois.

<img width="702" height="845" alt="image" src="https://github.com/user-attachments/assets/2db7e84c-8226-4152-84dc-62af0395fd5d" />

Outputtiin ilmestyi vain yksi linki, sitä klikkaamalla päästiin oikeeseen osoitteeseen.

<img width="1089" height="820" alt="image" src="https://github.com/user-attachments/assets/2fd5160a-bd17-495e-97c3-7bb6363417c8" />

F) Tehtävä 5: "Param Mining"

Kun yritää päästä hakemistoon http://localhost/cd/param/data, tulee seuraava errori.

<img width="1096" height="830" alt="image" src="https://github.com/user-attachments/assets/3234a22c-5a2f-48a3-b298-c6bc9587ec8d" />

Tehtävän tarkoitus on näyttää, vaikka meillä ei olisi pääsyä johonkin pintapuolisesti, kokeilemalla eri variaatioita osoitteesta voisi päästä meidät sisään.

Myös FUZZ:ia voi käyttää tälläkin tavalla, siihen laittaa esim. jonkun numeron perään niin se pystyy hakemaan eri hakemistoja missä on "=1" perässä

$ffuf -w wordlist/parameters.txt -u http://localhost/cd/param/data?FUZZ=1$

Kun käyttää seuraavaa komentoa, ilmestyy terminaaliin osoite mitä päästään katsomaan.

<img width="1152" height="838" alt="image" src="https://github.com/user-attachments/assets/40c5c2a5-316c-4c15-8cee-096e31c92f49" />

Kun klikkaa hyperlinkkiä, päästään oikealle sivulle.

Tehtävä 6: "Rate Limited"

Kun tiettyjä hakemistoja yrittää fuzza, niihin yleensä tulee vastaan rate limitti.

Rate limiitti tarkoitta sitä, että sivusto on rajoittamassa tietoverkon liikennettä, mikä tulee tietystä ip osoitteesta tai tietyllä aikasekvenssillä.

Mielenkiintoinen tässä oli se että -v ja -c ei antanut outputtiin tietoja mitkä hakemistot respondaa 429.

<img width="693" height="482" alt="image" src="https://github.com/user-attachments/assets/c7819d31-6708-4735-b139-ddcfbb0c1e92" />

Poistin myös komennosta -mc, ja lisäsin -v & -c, ei mitään tulosta. Johtopäätös on se, jos rate limitti tulee vastaan, en pääse näkee url outputtia ollenkaan.

Seuraavaksi lisäsin -t ja -p flagin, -p asettaa pienen hitauden fuzzamiselle, -t teke ffufista 5 eri versiota mikä tarkoittaa 50 pyyntöä sekunnissa (mitä tarkoittaa versio tässä kontekstissa?)

--lisäys-- 14.09.2025 21:29

$-t$ 5 tarkoittaa 5 eri yhteyttä, eikä varsinaista versiota ffufista. -t tekee työketjun "Thread", minä avulla se pystyy lähettää 5 itsenäistä pyyntöä kohteeseen.

--end--

Kuitenkin outputtiin ei ilmestynyt hyperlinkkiä.

Seuraavaksi asetin 0.2 delayn, ei siltikään mitään tulosta.

<img width="681" height="386" alt="image" src="https://github.com/user-attachments/assets/f965f0e3-bb67-4b7e-a9a7-935fb8cba428" />

Päätin kirjoittaa outputin txt tiedostoon, lisäämällä komentoon -o flagin.

$-o$ = tallentaa outputin määräämään tiedostoon

<img width="670" height="545" alt="image" src="https://github.com/user-attachments/assets/f4c01f38-7601-4bbe-b561-a28730b3a05e" />

txt tiedostosta ei ollut apua, sillä outputti näytti vaan tältä.

<img width="1910" height="289" alt="image" src="https://github.com/user-attachments/assets/a5f429ab-bead-4e44-8ec3-86d0137d0f03" />

Tässä vaiheessa päätin kysyä tekoälyltä apua. 

Tekoäly oli sitä mieltä että common.txt tiedostossa ei ole oraclee, kävin tarkistaa ja siellä se oli.

Tekoäly oli kans sitä mieltä että rate limitti tulee vastaan, (mitä itse epäilin myös) joten asetin -p flagin 0.5, silti ei mitään tulosta. 

Testasin vielä manuaalisesti, että oracle hakemisto on olemassa, siellä se oli.

<img width="1147" height="826" alt="image" src="https://github.com/user-attachments/assets/02130f74-31ea-480f-abac-b4460ae8f64c" />

Noin tunnin debuggamiseen jälkeen tajusin, että tehtävänannossa oli osoite ffuf.test, eikä localhost mikä poikkeaa muista komentoista tehtävänannossa. Tästä päätelleen tehtävä on joko virheellisesti tehty tai edellyttää että minulla on nettiyhteys mikä testaa rate limittiä.

Joten päätin testaa teoriaa, vaihdoin osoitteen locahostiksi tehtävän ensimmäisessä vaiheessa, ja sinne alkoi ilmestyä 429 http requesteja.

<img width="705" height="532" alt="image" src="https://github.com/user-attachments/assets/49308804-dc38-43a9-9312-0b7d278f8fe5" />

Tehtävän kakkos osassa asetin -p flagin ja -t flagin, oikeilla parametreillä, ja siitä löytyi oikea hakemisto.  

<img width="763" height="508" alt="image" src="https://github.com/user-attachments/assets/0b54a38f-6567-4f98-8653-6cd881543853" />

Tehtävä 7: Virtual Host Enumeration

Tehtävässä piti etsiä subdomaineja.

$-H$ = Hostia, headeria. 

<img width="746" height="612" alt="image" src="https://github.com/user-attachments/assets/5b0a14ed-a38d-4df7-8917-466c2ef50d58" />

Tällä komennolla syntyi kasa domaineja, suurimmalla osalla oli yhtenäinen tekijä size 1495. (sample size 20)

Siitä päätelleen voidaan käyttää fs komentoa mikä suodattaa 1495 requestit pois outputista. 

Suodattimen kanssa outputti oli seuraava:

<img width="752" height="553" alt="image" src="https://github.com/user-attachments/assets/89960cfa-e823-4c0d-81e3-f1cfc5e68a43" />

Lähteet: 

https://github.com/ffuf/ffuf
https://terokarvinen.com/tunkeutumistestaus/#laksyt
[Tekoäly, malli Claude:Opus 4.0](https://claude.ai/chat/e5ff140a-cbb9-489f-b1a9-fb3d8729d7b5)
https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/
https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

